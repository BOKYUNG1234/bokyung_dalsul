<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dalsul.user.pay.dao.PayDAO">


<insert id="orderInsert" parameterType="pay">
INSERT INTO order_list (order_no, user_no, order_use_coupon, order_dlv_fee, order_total_price,
                             order_delivery_info, order_status, order_date, order_update_date)
    VALUES (order_list_seq.NEXTVAL, #{user_no},  #{order_use_coupon}, 3000, #{order_total_price},
            #{order_delivery_info},  '결제 완료', SYSDATE, SYSDATE)
</insert>

<select id="getOrderNo" parameterType="pay" resultType="int">
	select max(order_no)
	from order_list
	where user_no = #{user_no}
</select>

<insert id="orderDetail" parameterType="pay">
	INSERT INTO product_order 
    VALUES (product_order_seq.nextval,#{order_no},#{product_no},#{user_no},#{quantity})
</insert>



<delete id="cartDelete" parameterType="cart">
    DELETE FROM cart_list 
    WHERE cart_id = #{cart_id} 
    AND cart_id IN (SELECT cart_id FROM cart WHERE user_no = #{cart_id})
</delete>

</mapper>

